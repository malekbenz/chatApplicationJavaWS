<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>

	<h1>Chat Application</h1>

	<form action="">
		<table>
			<tr>
				<td>All Messages<br /> <textarea rows="15" cols="40"
						id="textmessage" readonly="readonly"></textarea></td>
				<td>Sensors<br /> <textarea readonly="readonly" rows="16"
						cols="15" id="sensors"></textarea>
				</td>
			</tr>
			<tr>
				<td colspan="2"><input id="textField" size="70" type="text" />
					<input onclick="sendMessage();" value="SendMessage" type="button" />
					<input onclick="disconnect();" value="Disconnect" type="button" />
				</td>
			</tr>
		</table>
	</form>
	<div id="output"></div>

	<script>
		var ws = new WebSocket("ws://localhost:8080/PSW/messagingendpoint");
		var textField = document.getElementById("textField");
		var textmessage = document.getElementById("textmessage");
		var sensor = document.getElementById("sensors");
	
		var output = document.getElementById("output");
		 ws.onopen = function(evt) {
		 onOpen(evt);
		 };
		 ws.onmessage = function(evt) {
		 onMessage(evt);
		 };
		 ws.onerror = function(evt) {
		 onError(evt);
		 };
		 ws.onclose = function(evt) {
		 onClose(evt);
		 };
		function onMessage(evt) {
		 var jsdata = JSON.parse(evt.data);
		 if (jsdata.message != null) {
		 if (evt.data.indexOf(">") !== -1) {
		 var sensorname = evt.data.substring(evt.data.indexOf(">") + 1,
		 evt.data.length - 2);
		 sensor.innerHTML += sensorname;
		 } else

		 textmessage.value += jsdata.message + "\n";
		 writeToScreen("RECEIVED: " + evt.data);
		 }
		 } 

		
		</script>
</body>
</html>
